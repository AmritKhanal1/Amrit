<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ShikshaFlow Document Viewer</title>

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;600;700&display=swap" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<style>
* {
    box-sizing: border-box;
}

body {
    margin: 0;
    font-family: Roboto, sans-serif;
    background: #f1f3f5;
    color: #212529;
}

/* Layout */
#app {
    display: grid;
    grid-template-rows: 60px 50px 1fr 35px;
    height: 100vh;
}

/* Header */
header {
    background: #0d6efd;
    color: white;
    display: flex;
    align-items: center;
    padding: 0 24px;
    font-size: 18px;
    font-weight: 700;
}

/* Toolbar */
#toolbar {
    background: #ffffff;
    border-bottom: 1px solid #dee2e6;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
}

#toolbar button {
    background: #e9ecef;
    border: none;
    padding: 6px 10px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
}

#toolbar button:hover {
    background: #ced4da;
}

#pageInfo {
    margin-left: auto;
    font-size: 14px;
}

/* Viewer */
#viewer-container {
    overflow: auto;
    display: flex;
    justify-content: center;
    padding: 20px;
}

canvas {
    background: white;
    box-shadow: 0 4px 12px rgba(0,0,0,.15);
    border-radius: 6px;
}

/* Footer */
footer {
    background: #198754;
    color: white;
    font-size: 12px;
    display: flex;
    align-items: center;
    padding: 0 12px;
}

footer span:last-child {
    margin-left: auto;
    opacity: 0.85;
}

/* Disable selection */
body {
    user-select: none;
}
</style>
</head>

<body oncontextmenu="return false">

<div id="app">

<header>
    ðŸ“˜ ShikshaFlow Document Viewer
</header>

<div id="toolbar">
    <button onclick="prevPage()">â—€</button>
    <button onclick="nextPage()">â–¶</button>
    <button onclick="zoomOut()">âž–</button>
    <button onclick="zoomIn()">âž•</button>
    <button onclick="rotate()">âŸ³</button>
    <button onclick="fitWidth()">Fit Width</button>
    <button onclick="toggleFullscreen()">â›¶</button>

    <div id="pageInfo">Page 1 / 1</div>
</div>

<div id="viewer-container">
    <canvas id="pdfCanvas"></canvas>
</div>

<footer>
    <span id="status">Loading documentâ€¦</span>
    <span>Â© 2026 ShikshaFlow | Designed by Amrit</span>
</footer>

</div>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

const canvas = document.getElementById('pdfCanvas');
const ctx = canvas.getContext('2d');
const statusText = document.getElementById('status');
const pageInfo = document.getElementById('pageInfo');

let pdfDoc = null;
let pageNum = 1;
let scale = 1.2;
let rotation = 0;

/* Load PDF */
const params = new URLSearchParams(window.location.search);
const file = params.get('file');

if (!file) {
    statusText.textContent = 'No document specified';
    throw new Error('Missing file parameter');
}

pdfjsLib.getDocument(file).promise.then(pdf => {
    pdfDoc = pdf;
    renderPage();
    statusText.textContent = 'Document loaded';
});

/* Render page */
function renderPage() {
    pdfDoc.getPage(pageNum).then(page => {
        const viewport = page.getViewport({ scale, rotation });
        canvas.width = viewport.width;
        canvas.height = viewport.height;

        page.render({
            canvasContext: ctx,
            viewport: viewport
        });

        pageInfo.textContent = `Page ${pageNum} / ${pdfDoc.numPages}`;
    });
}

/* Controls */
function nextPage() {
    if (pageNum < pdfDoc.numPages) {
        pageNum++;
        renderPage();
    }
}

function prevPage() {
    if (pageNum > 1) {
        pageNum--;
        renderPage();
    }
}

function zoomIn() {
    scale += 0.2;
    renderPage();
}

function zoomOut() {
    if (scale > 0.4) {
        scale -= 0.2;
        renderPage();
    }
}

function rotate() {
    rotation = (rotation + 90) % 360;
    renderPage();
}

function fitWidth() {
    const containerWidth = document.getElementById('viewer-container').clientWidth;
    pdfDoc.getPage(pageNum).then(page => {
        const viewport = page.getViewport({ scale: 1 });
        scale = containerWidth / viewport.width;
        renderPage();
    });
}

function toggleFullscreen() {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
    } else {
        document.exitFullscreen();
    }
}
</script>

</body>
</html>